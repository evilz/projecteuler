@namespace Projecteuler.Components.Problems
@page "/problem/44"
@inherits ProblemBase

@{
    base.BuildRenderTree(__builder);
}

@code {
    protected override int Ref => 44;

    protected override string ProblemTitle => "Pentagon Numbers";

    protected override string Description => "<p>Pentagonal numbers are generated by the formula, $P_n=n(3n-1)/2$. The first ten pentagonal numbers are:\n$$1, 5, 12, 22, 35, 51, 70, 92, 117, 145, \\\\dots$$</p>\n<p>It can be seen that $P_4 + P_7 = 22 + 70 = 92 = P_8$. However, their difference, $70 - 22 = 48$, is not pentagonal.</p>\n<p>Find the pair of pentagonal numbers, $P_j$ and $P_k$, for which their sum and difference are pentagonal and $D = |P_k - P_j|$ is minimised; what is the value of $D$?</p>";

    protected override string Explanation => "We iterate through pentagonal numbers $P_k$ and then through $P_j$ (where $j < k$). We check if $P_k - P_j$ and $P_k + P_j$ are also pentagonal. The first such difference $D$ found is likely the minimum because we are iterating in increasing order of $k$.";

    protected override long Resolve()
    {
        long result = 0;
        bool found = false;
        int i = 1;

        while (!found)
        {
            i++;
            long n = (long)i * (3 * i - 1) / 2;

            for (int j = i - 1; j > 0; j--)
            {
                long m = (long)j * (3 * j - 1) / 2;
                if (IsPentagonal(n - m) && IsPentagonal(n + m))
                {
                    result = n - m;
                    found = true;
                    break;
                }
            }
        }
        return result;
    }

    private bool IsPentagonal(long n)
    {
        double penTest = (Math.Sqrt(1 + 24 * n) + 1) / 6;
        return penTest == (int)penTest;
    }
}


