@inherits LayoutComponentBase
@inject NavigationManager Navigation
@using Microsoft.AspNetCore.Components.Routing
@using Spectre.Console
@using RazorConsole.Components
@namespace Projecteuler.Components

<Rows>
    <Figlet Content="Project Euler" Color="Color.Blue" />
    <Markup Content="Solve Project Euler problems using RazorConsole." Foreground="@Color.Grey70" />
    <Newline />

    <Panel Title="Problem Selector" Border="BoxBorder.Rounded" Expand="true">
        <Rows>
            <Select Options="@_problemOptions.Select(num => _problemTitles[num]).ToArray()"
                    Value="@(_selectedRef != null && _problemTitles.ContainsKey(_selectedRef) ? _problemTitles[_selectedRef] : null)"
                    ValueChanged="@(value => OnSelectionChanged(_problemOptions.First(num => _problemTitles[num] == value)))"
                    Placeholder="Choose a problem" />
        </Rows>
    </Panel>

    <Newline />
    @Body
</Rows>

@code {
    private Dictionary<string, string> _problemTitles = new Dictionary<string, string>
    {
        { "1", "1: Multiples of 3 or 5" },
        { "2", "2: Even Fibonacci Numbers" },
        { "3", "3: Largest Prime Factor" },
        { "4", "4: Largest Palindrome Product" },
        { "5", "5: Smallest Multiple" },
        { "6", "6: Sum Square Difference" },
        { "7", "7: 10 001st Prime" },
        { "8", "8: Largest Product in a Series" },
        { "9", "9: Special Pythagorean Triplet" },
        { "10", "10: Summation of Primes" },
        { "11", "11: Largest Product in a Grid" },
        { "12", "12: Highly Divisible Triangular Number" },
        { "13", "13: Large Sum" },
        { "14", "14: Longest Collatz Sequence" },
        { "15", "15: Lattice Paths" },
        { "16", "16: Power Digit Sum" },
        { "17", "17: Number Letter Counts" },
        { "18", "18: Maximum Path Sum I" },
        { "19", "19: Counting Sundays" },
        { "20", "20: Factorial Digit Sum" }
    };

    private string[] _problemOptions = new[] { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20" }; 
    private string? _selectedRef;

    private void OnSelectionChanged(string value)
    {
         _selectedRef = value;
         Navigation.NavigateTo($"/problem/{value}");
    }
}
